{% extends "base_generic.html" %}

{% block title %} <title>filter</title> {% endblock %}

{% block content %}

{% load static %}
<link rel ="stylesheet"  href="{% static 'css/filter.css' %}">
<link rel ="stylesheet"  href="{% static 'css/style.css' %}"> 
<div class = "container-fluid" style="padding: 20px;">
<div class = "row">
  <div class = "col-md checkbox" style="background-color: rgba(35, 68, 75, 0.7); border-radius: 10px; padding: 30px; margin: 10px;">
    <form action="" method="POST">
      {% csrf_token %}
        <div class="col" style="justify-content: center;">
        {% for area in areas %}
          {% if area in applied%}
          <li class="style_check" style="padding: 5px;">
            <input class="input_checkbox" type="checkbox" name="{{ area }}" value="{{ area }}" checked>
            <p style="color: black;">&nbsp&nbsp{{ area }}</p>
          </li>
          {% else %}
          <li class="style_check" style="padding: 5px;">
            <input class="input_checkbox" type="checkbox" name="{{ area }}" value="{{ area }}" unchecked>
            <p style="color: black;">&nbsp&nbsp{{ area }}</p>
          </li>
          {% endif %}
        {% endfor %}
        </div>
        <input type="submit" value="Aplicar filtros" class="btnn_check" style="font-family: "Montserrat", sans-serif;">
    </form>
  </div>
  <div class = "col-md-9 table">
  <table class="table table-striped table-hover">
    <thead>
      <tr style="font-family: "Montserrat", sans-serif;">
        <th scope="col">Nombre</th>
        <th scope="col">Apellido</th>
        <th scope="col">Cargo</th>
        <th scope="col">Empresa</th>
        <th scope="col">Rating</th>
      </tr>
    </thead>

  {% if results %}
    {% for result in results %}
      <tbody>
        <tr>
          <td scope="row"><a class="link_mentor" href="{{ result.get_absolute_url }}"><p class = "table-data">{{result.first_name}}</p></a></td>
          <td><a class="link_mentor" href="{{ result.get_absolute_url }}"><p class = "table-data">{{result.last_name}}</p></a></td>
          <td><a class="link_mentor" href="{{ result.get_absolute_url }}"><p class = "table-data">{{result.charge}}</p></a></td>
          <td><a class="link_mentor" href="{{ result.get_absolute_url }}"><p class = "table-data">{{result.company}}</p></a></td>
          <td><a class="link_mentor" href="{{ result.get_absolute_url }}"><p class = "table-data"><span id="stars2"></span></p></a></td>
        </tr>
      </tbody>

      <script id="stars-script" mentorRating={{ result.rating }}>
        const mentorRating = document.getElementById("stars-script").getAttribute("mentorRating");

        document.getElementById("stars2").innerHTML = getStars(mentorRating);

        function getStars(rating) {

          // Round to nearest half
          rating = Math.round(rating * 2) / 2;
          let output = [];

          // Append all the filled whole stars
          for (var i = rating; i >= 1; i--)
            output.push('<i class="fa fa-star" aria-hidden="true" style="color: gold;"></i>&nbsp;');

          // If there is a half a star, append it
          if (i == .5) output.push('<i class="fa fa-star-half-o" aria-hidden="true" style="color: gold;"></i>&nbsp;');

          // Fill the empty stars
          for (let i = (5 - rating); i >= 1; i--)
            output.push('<i class="fa fa-star-o" aria-hidden="true" style="color: gold;"></i>&nbsp;');

          return output.join('');

        }
      </script>
    {% endfor %}  
  </table>

  {% else %}
  
  <p class="hola"> No hay mentores con esta expertise</p>
  {% endif %}
      </div>
    </div>
  </div>
  <br><br><br>
{% endblock %}